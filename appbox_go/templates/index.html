<!DOCTYPE html>
<html lang="en">

<head>
            <meta charset="UTF-8">
            <title>appbox</title>
            <meta name="viewport" content="width=device-width, initial-scale=1">
            <meta name="referrer" content="no-referrer">
            <link rel="icon" class="js-site-favicon" type="image/svg+xml" href="https://svgsilh.com/svg/33581.svg">
            <link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.css">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css">
            <script src="http://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
            <script src="http://cdn.bootcss.com/popper.js/1.12.5/umd/popper.min.js"></script>
            <script src="http://cdn.bootcss.com/bootstrap/4.0.0-beta/js/bootstrap.min.js"></script>
            <script src="http://cdn.bootcss.com/vue/2.5.8/vue.min.js"></script>
            <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

</head>

<body>
            <div class="container" id="vueApp">
                        <div class="row mx-auto w-75" style="margin-top: 20px">
                                    <div class="col-12 text-center">
                                                <h3>App Box ü¶â</h3>
                                    </div>
                        </div>
                        <div class="row mx-auto w-75" style="height: 15px"></div>
                        <div class="row mx-auto w-75">
                                    <div class="col-6">
                                                <div class="btn-group">
                                                            <button type="button" class="btn btn-outline-info btn-sm"
                                                                        data-toggle="modal"
                                                                        data-target="#myModal">Êñ∞Â¢û</button>

                                                            <button type="button" class="btn btn-outline-primary btn-sm"
                                                                        @click="saveRows">‰øùÂ≠ò</button>
                                                </div>
                                                <button type="button" class="btn btn-outline-warning btn-sm"
                                                            @click="delRows">Âà†Èô§</button>
                                    </div>
                                    <div class="col-6">
                                                <div class="input-group">
                                                            <input type="text" class="form-control input-group-sm"
                                                                        placeholder="ËæìÂÖ•Â∫îÁî®idËøõË°åÊêúÁ¥¢">
                                                            <span class="input-group-btn">
                                                                        <button class="btn btn-default" type="button"><i
                                                                                                class="fa fa-search"></i></button>
                                                            </span>
                                                </div>
                                    </div>
                        </div>
                        <div class="row mx-auto w-75" style="height: 15px"></div>
                        <div class="row mx-auto w-75">
                                    <div class="col-22">
                                                <table class="table table-hover table-success">
                                                            <thead class="thead-default">
                                                                        <tr>
                                                                                    <th><input type="checkbox"></th>
                                                                                    <th>Â∫èÂè∑</th>
                                                                                    <th>Â∫îÁî®ÂêçÁß∞</th>
                                                                                    <th>Â∫îÁî®Á±ªÂûã</th>
                                                                                    <th>ÂüüÂêç</th>
                                                                                    <th>ÊäÄÊúØÊ†à</th>
                                                                                    <th>ÂâçÁ´ØÁ´ØÂè£</th>
                                                                                    <th>ÂêéÁ´ØÁ´ØÂè£</th>


                                                                        </tr>
                                                            </thead>
                                                            <tbody>
                                                                        <tr v-for=" (app,index)  in apps" >
                                                                                    <td><input type="checkbox"
                                                                                                :key="app"
                                                                                                            :value="index"
                                                                                                            v-model="checkedRows">
                                                                                    </td>
                                                                                    <td>{{app.id}}</td>
                                                                                    <td>{{app.app_name}}</td>
                                                                                    <td>{{app.app_type}}</td>
                                                                                    <td>{{app.domain}}</td>
                                                                                    <td>{{app.stack}}</td>
                                                                                    <td>{{app.fontport}}</td>
                                                                                    <td>{{app.backendport}}</td>


                                                                        </tr>
                                                            </tbody>
                                                </table>
                                    </div>
                        </div>
                        <!-- Ê®°ÊÄÅÊ°Ü -->
                        <div class="modal fade" id="myModal">
                                    <div class="modal-dialog">
                                                <div class="modal-content">
                                                            <div class="modal-header">
                                                                        <h4 class="modal-title">Êñ∞Â¢ûÂ∫îÁî®‰ø°ÊÅØ</h4>
                                                                        <button type="button" class="close"
                                                                                    data-dismiss="modal">&times;</button>
                                                            </div>
                                                            <div class="modal-body">
                                                                        <div class="row">
                                                                                    <div class="col-3">Â∫îÁî®ÂêçÁß∞Ôºö</div>
                                                                                    <div class="col-9">
                                                                                                <input class="form-control"
                                                                                                            placeholder="Â∫îÁî®ÂêçÁß∞"
                                                                                                            v-model="newRow.app_name">
                                                                                    </div>
                                                                        </div>
                                                                        <div class="row">
                                                                                    <div class="col-3">Â∫îÁî®Á±ªÂûãÔºö</div>
                                                                                    <div class="col-9">
                                                                                                <input class="form-control"
                                                                                                            placeholder="Â∫îÁî®Á±ªÂûã"
                                                                                                            v-model="newRow.app_type">
                                                                                    </div>
                                                                        </div>
                                                                        <div class="row">
                                                                                    <div class="col-3">ÂüüÂêçÔºö</div>
                                                                                    <div class="col-9">
                                                                                                <input class="form-control"
                                                                                                            placeholder="ÂüüÂêç"
                                                                                                            v-model="newRow.domain">
                                                                                    </div>
                                                                        </div>

                                                                        <div class="row">
                                                                                    <div class="col-3">ÊäÄÊúØÊ†àÔºö</div>
                                                                                    <div class="col-9">
                                                                                                <input class="form-control"
                                                                                                            placeholder="ÊäÄÊúØÊ†à"
                                                                                                            v-model="newRow.stack">
                                                                                    </div>
                                                                        </div>
                                                                        <div class="row">
                                                                                    <div class="col-3">ÂâçÁ´ØÁ´ØÂè£Ôºö</div>
                                                                                    <div class="col-9">
                                                                                                <input class="form-control"
                                                                                                            placeholder="ÂâçÁ´ØÁ´ØÂè£"
                                                                                                            v-model="newRow.font_port">
                                                                                    </div>
                                                                        </div>
                                                                        <div class="row">
                                                                                    <div class="col-3">ÂêéÁ´ØÁ´ØÂè£Ôºö</div>
                                                                                    <div class="col-9">
                                                                                                <input class="form-control"
                                                                                                            placeholder="ÂêéÁ´ØÁ´ØÂè£"
                                                                                                            v-model="newRow.backend_port">
                                                                                    </div>
                                                                        </div>
                                                                        <div class="row">
                                                                                    <div class="col-3">ÂÖ∂‰ªñÔºö</div>
                                                                                    <div class="col-9">
                                                                                                <input class="form-control"
                                                                                                            placeholder="ÂÖ∂‰ªñ"
                                                                                                            v-model="newRow.others">
                                                                                    </div>
                                                                        </div>


                                                            </div>
                                                            <div class="modal-footer">
                                                                        <button type="button"
                                                                                    class="btn btn-outline-primary"
                                                                                    data-dismiss="modal"
                                                                                    @click="addRow">Á°ÆËÆ§</button>
                                                            </div>
                                                </div>
                                    </div>
                        </div>
            </div>

            <script src="https://unpkg.com/axios/dist/axios.min.js"></script>



            <script>


                        new Vue({
                                    el: "#vueApp",
                                    data: {
                                                checkAll: false,
                                                checkedRows: [],
                                                apps: "",
                                                newRow: {}
                                    },
                                    provide() {
                                                reload: this.reload
                                    },
                                    inject: ['reload'],
                                    methods: {
                                                addRow: function () {
                                                            this.apps.push(this.newRow);

                                                            let data = new FormData();
                                                            // data.append("app_name",this.newRow.app_name)

                                                            axios.post("/appbox/api", {
                                                                        "app_name": this.newRow.app_name,
                                                                        "app_type": this.newRow.app_type,
                                                                        "domain": this.newRow.domain,
                                                                        "stack": this.newRow.stack,
                                                                        "fontport": this.newRow.font_port,
                                                                        "backendport": this.newRow.backend_port,

                                                            }).then(
                                                                        (res) => {
                                                                                    console.info(res);
                                                                                    this.reload();
                                                                                    this.$notify({
                                                                                                group: 'foo',
                                                                                                type: 'success',
                                                                                                text: 'Ê∑ªÂä†ÊàêÂäü'
                                                                                    });

                                                                        }
                                                            ).catch(
                                                                        (error) => {
                                                                                    console.error(error)
                                                                        }
                                                            )




                                                            console.log(this.newRow);
                                                            this.newRow = {};
                                                            location.reload(); // ÈáçÊñ∞Âä†ËΩΩ
                                                },
                                                saveRows: function () {//‰øùÂ≠òË°®Ê†ºÊï∞ÊçÆ

                                                },
                                                delRows: function () {
                                                            if (this.checkedRows.length <= 0) {
                                                                        alert("ÊÇ®Êú™ÈÄâÊã©ÈúÄË¶ÅÂà†Èô§ÁöÑÊï∞ÊçÆ");
                                                                        return false;
                                                            }
                                                            if (!confirm("ÊÇ®Á°ÆÂÆöË¶ÅÂà†Èô§ÈÄâÊã©ÁöÑÊï∞ÊçÆÂêóÔºü")) {
                                                                        return false;
                                                            }

                                                            var remove_id = String(this.apps[this.checkedRows[0]]["id"]);
                                                            console.log(remove_id);
                                                            axios.delete('/appbox/api' + '/' + remove_id).then((res) => {
                                                                        this.reload();
                                                                        this.$notify({
                                                                                    group: 'foo',
                                                                                    type: 'info',
                                                                                    text: 'Âà†Èô§ÊàêÂäü'
                                                                        });
                                                                        this.reload()
                                                            }).catch((error) => {
                                                                        console.log(error)
                                                            })


                                                            location.reload(); // Âà†Èô§ÂêéÈáçÊñ∞Âä†ËΩΩ
                                                },

                                                getAllDT: function () {
                                                            axios.get('/appbox/api', {
                                                                        Headers: {
                                                                                    "Access-Control-Allow-Origin": "*",
                                                                                    "Access-Control-Allow-Methods": "POST,GET,PUT,DELETE",
                                                                                    "Access-Control-Allow-Headers": "Content-Type"
                                                                        }
                                                            })
                                                                        .then((res) => {

                                                                                    this.apps = res.data;

                                                                        }).catch((error) => {
                                                                                    console.log(error)
                                                                        });


                                                }

                                    },
                                    mounted() {
                                                this.getAllDT()
                                    }



                        })
            </script>
</body>

</html>